<div class="admin-page">
  <div class="page-header">
    <h1>Localities</h1>
    <button class="btn-accent" (click)="addNewLocality()">+ Add Locality</button>
  </div>

  <!-- Add new form -->
  <div class="form-card" *ngIf="isAddingNew" style="margin-bottom: 24px;">
    <h3>New Locality</h3>
    <form [formGroup]="editForm" (ngSubmit)="createLocality()">
      <div class="form-grid" style="margin-top: 16px;">
        <div class="form-group">
          <label for="nameLo">Name</label>
          <input type="text" id="nameLo" formControlName="nameLo" />
          <span class="error-message" *ngIf="hasError('nameLo', 'required')">Required</span>
        </div>
        <div class="form-group">
          <label for="postalCode">Postal Code</label>
          <input type="number" id="postalCode" formControlName="postalCode" />
          <span class="error-message" *ngIf="hasError('postalCode', 'required')">Required</span>
        </div>
        <div class="form-group">
          <label for="cost">Shipping Cost</label>
          <input type="number" id="cost" formControlName="cost" min="0" />
          <span class="error-message" *ngIf="hasError('cost', 'required')">Required</span>
        </div>
      </div>
      <div class="form-actions">
        <button type="submit" class="btn-accent" [disabled]="editForm.invalid">Create</button>
        <button type="button" class="btn-ghost" (click)="cancelAdd()">Cancel</button>
      </div>
    </form>
  </div>

  <!-- Localities grid -->
  <div class="localities-grid" *ngIf="localities.length > 0">
    <div class="loc-card" *ngFor="let locality of localities" [class.inactive]="!locality.isActive">
      <!-- View mode -->
      <div class="loc-view" *ngIf="editingLocality?.idLo !== locality.idLo">
        <div class="loc-info">
          <h3>{{ locality.nameLo }}</h3>
          <div class="loc-meta">
            <span>CP: {{ locality.postalCode }}</span>
            <span>Cost: ${{ locality.cost }}</span>
          </div>
        </div>
        <div class="loc-actions">
          <button class="btn-ghost" (click)="editLocality(locality)">Edit</button>
          <button class="btn-ghost btn-danger-ghost" (click)="deleteLocality(locality)"
            *ngIf="locality.isActive">Deactivate</button>
          <button class="btn-ghost btn-success-ghost" (click)="activateLocality(locality)"
            *ngIf="!locality.isActive">Activate</button>
        </div>
      </div>

      <!-- Edit mode -->
      <div class="loc-edit" *ngIf="editingLocality?.idLo === locality.idLo">
        <form [formGroup]="editForm" (ngSubmit)="updateLocality()">
          <div class="form-group">
            <label>Name</label>
            <input type="text" formControlName="nameLo" />
          </div>
          <div class="form-group">
            <label>Postal Code</label>
            <input type="number" formControlName="postalCode" [attr.disabled]="true" />
            <small class="hint">Cannot be changed</small>
          </div>
          <div class="form-group">
            <label>Cost</label>
            <input type="number" formControlName="cost" min="0" />
          </div>
          <div class="form-actions">
            <button type="submit" class="btn-accent" [disabled]="editForm.invalid">Save</button>
            <button type="button" class="btn-ghost" (click)="cancelEdit()">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>